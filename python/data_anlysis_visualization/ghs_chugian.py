from openpyxl import Workbook , load_workbook 
from openpyxl.styles import  Font ,Alignment
from datetime import datetime

def calculate_age (dob):
    dob = datetime.strptime(dob, "%Y-%m-%d")
    today = datetime.now()
    age = today - dob
    total_days = age.days
    years = total_days // 365
    return years

wb = Workbook()

sheet1 = wb.active()
sheet1.title = "All Students"
sheet1.append(['Name','Father Name','Age(Years)','B-Form No','DOB','Class'])
student_data = [('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),('','',,'',),]

for student in student_data:
    sheet1.append(student[0:2] + (calculate_age(student[3],)) + student[2:3] + student[3:])
